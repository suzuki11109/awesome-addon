<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="//aui-cdn.atlassian.com/aui-adg/5.9.12/css/aui.min.css" media="all">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
  </head>
  <body>
    <section id="content">
      <button id="insert">Try insert</button>
    </section>
    <script id="connect-loader">
      (function() {
        var getUrlParam = function (param) {
          var codedParam = (new RegExp(param + '=([^&]*)')).exec(window.location.search)[1];
          return decodeURIComponent(codedParam);
        };

        var baseUrl = getUrlParam('xdm_e') + getUrlParam('cp');
        var options = document.getElementById('connect-loader').getAttribute('data-options');

        var script = document.createElement("script");
        script.src = baseUrl + '/atlassian-connect/all.js';

        if(options) {
          script.setAttribute('data-options', options);
        }

        document.getElementsByTagName("head")[0].appendChild(script);
      })();
    </script>
    <script type="text/javascript">
      (function () {
        console.log("Running awesome script.");

        var url = "http://i.giphy.com/aLdiZJmmx4OVW.gif";

        $('#insert').click(function() {
          console.log('here clicked');
          AP.require(["confluence"], function (confluence) {
            confluence.saveMacro({
              'url': url
            });

            confluence.closeMacroEditor();
          });
        });

      })();
    </script>
  </body>
</html>
